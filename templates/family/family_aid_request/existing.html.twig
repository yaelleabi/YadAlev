{% extends 'base.html.twig' %}
{% block title %}Espace Famille - Demande en cours{% endblock %}

{% block body %}

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm py-2 fixed-top">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
            <img src="{{ asset('images/LOGO.PNG') }}" alt="Logo Yad Alev" class="nav-logo">
            <span class="fw-bold text-primary fs-5">Espace Famille</span>
        </div>

        <div class="d-flex align-items-center gap-4">
            <a href="{{ path('app_family_show', {id:family.id}) }}" class="nav-icon" title="Mes informations">
                <i class="fas fa-user-circle"></i>
            </a>
            <a href="{{ path('app_logout') }}" class="nav-icon" title="Se déconnecter">
                <i class="fas fa-sign-out-alt"></i>
            </a>
        </div>
    </div>
</nav>


<!-- CONTENU PRINCIPAL -->
<div class="main-container ">

    <div class="content-wrapper d-flex flex-column justify-content-start align-items-center">

        <!-- MESSAGE -->
        <div class="mt-5 pt-4 fade-in" style="max-width: 650px;">
            <div class="info-card-custom p-4 text-center">

                <h3 class="text-primary fw-bold mb-3">Votre demande est en cours de traitement</h3>
                {% if aid_request %}
                <p class="mt-3">
                    <strong>Statut de votre demande :</strong><br>

                    {% if aid_request.status.value == 'En attente' %}
                        <span class="badge bg-warning text-dark">En attente</span>

                    {% elseif aid_request.status.value == 'Acceptée' %}
                        <span class="badge bg-success">Acceptée</span>

                    {% elseif aid_request.status.value == 'Refusée' %}
                        <span class="badge bg-danger">Refusée</span>
                    {% endif %}

                </p>
               {% endif %}

                {% if aid_request.status.value in ['Acceptée', 'Refusée'] %}

                <p class="text-muted">
                    Votre demande précédente a été traitée. <br>
                    Vous pouvez maintenant en soumettre une nouvelle si nécessaire.
                </p>

                    <a href="{{ path('app_aidrequest_renew', {id: aid_request.id}) }}" 
                       class="btn btn-primary mt-3 px-4">
                        Faire une nouvelle demande
                    </a>

                {% else %}

                    <p class="text-muted">
                        Une demande d’aide a déjà été soumise et est en cours de traitement. <br>
                        Vous pouvez la modifier si nécessaire :
                    </p>

                    <a href="{{ path('app_aidrequest_edit', {id: aid_request.id}) }}" class="btn btn-primary mt-3 px-4">
                        Modifier ma demande
                    </a>

                {% endif %}

            </div>
        </div>

    </div>

    <!-- FOOTER -->
    <footer class="footer-custom text-center text-muted small py-4">
        <div class="footer-line mx-auto"></div>

        <div class="footer-content mt-3">
            <img src="{{ asset('images/LOGO.PNG') }}" alt="Yad Alev" class="footer-logo mb-1">
            <p class="m-0">© 2025 Espace Famille Yad Alev — Tous droits réservés.</p>
        </div>
    </footer>

</div>


<style>

/* NAVBAR */
.navbar {
    border-bottom: 1px solid #e2e8f0;
    z-index: 2000;
}
.nav-logo { width: 48px; }
.nav-icon {
    font-size: 1.4rem;
    color: #444;
    transition: .2s;
}
.nav-icon:hover {
    color: #0d6efd;
    transform: translateY(-2px);
}


/* LAYOUT */
.main-container {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}
.content-wrapper {
    flex: 1;
    width: 100%;
}

/* CARD MESSAGE */
.info-card-custom {
    background: #fff;
    border-radius: 1rem;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border: 1px solid #e2e8f0;
    animation: fadeSlide .7s ease forwards;
}

/* Animation */
.fade-in {
    opacity: 0;
    animation: fadeSlide .7s ease forwards;
}
@keyframes fadeSlide {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* FOOTER */
.footer-custom { margin-top: auto; }
.footer-line {
    width: 85%;
    height: 1px;
    background: #d0d7e0;
}
.footer-logo {
    width: 60px;
    opacity: .9;
}

/* Responsive */
@media (max-width: 768px) {
    .nav-logo { width: 40px; }
    h3 { font-size: 1.4rem; }
    .footer-logo { width: 50px; }
}
</style>

{% endblock %}
