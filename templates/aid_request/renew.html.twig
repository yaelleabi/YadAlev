{% extends 'base.html.twig' %}

{% block title %}Faire une nouvelle demande d‚Äôaide - Yad Alev{% endblock %}

{% block body %}

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm py-2 fixed-top">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
            <img src="{{ asset('images/LOGO.PNG') }}" alt="Logo Yad Alev" class="nav-logo">
            <span class="fw-bold text-primary fs-5">Faire une nouvelle demande d‚Äôaide</span>
        </div>
        <div class="d-flex align-items-center gap-4">
            <a href="{{ path('app_aidrequest_existing') }}" class="nav-icon" title="Retour"><i class="fas fa-home"></i></a>
            <a href="{{ path('app_logout') }}" class="nav-icon" title="D√©connexion"><i class="fas fa-sign-out-alt"></i></a>
        </div>
    </div>
</nav>

<div class="main-container">
    <div class="content-wrapper container">

        <div class="text-center mb-5 fade-in">
            <h2 class="text-primary fw-bold">Faire une nouvelle demande d‚Äôaide</h2>
            {% if oldRequest %}
                <p class="text-muted">Derni√®re demande le : <strong>{{ oldRequest.createdAt|date('d/m/Y') }}</strong></p>
            {% endif %}
        </div>

        <form action="{{ path('app_aidrequest_renew_submit', {'id': oldRequest.id}) }}" 
              method="POST" 
              enctype="multipart/form-data" 
              novalidate>

            {{ form_widget(form._token) }}

            {% if form_errors(form) %}
                <div class="alert alert-danger">{{ form_errors(form) }}</div>
            {% endif %}

            <div class="info-card shadow-sm fade-in p-4">
                <div class="accordion" id="renewAccordion">

                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#id1">1. Identit√©</button>
                        </h2>
                        <div id="id1" class="accordion-collapse collapse show">
                            <div class="accordion-body">
                                {{ form_row(form.lastName) }}
                                {{ form_row(form.firstName) }}
                                {{ form_row(form.dateOfBirth) }}
                                {{ form_row(form.email) }}
                                {{ form_row(form.phoneNumber) }}
                            </div>
                        </div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#id2">2. Famille & logement</button></h2>
                        <div id="id2" class="accordion-collapse collapse"><div class="accordion-body">
                            {{ form_row(form.maritalStatus) }}
                            {{ form_row(form.dependantsCount) }}
                            {{ form_row(form.housingStatus) }}
                            <h5 class="mt-3">Adresse</h5>
                            {{ form_row(form.adress.streetNumber) }}
                            {{ form_row(form.adress.street) }}
                            {{ form_row(form.adress.postalCode) }}
                            {{ form_row(form.adress.city) }}
                        </div></div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#id3">3. Finances</button></h2>
                        <div id="id3" class="accordion-collapse collapse"><div class="accordion-body">
                            {{ form_row(form.employmentStatus) }}
                            {{ form_row(form.monthlyIncome) }}
                            {{ form_row(form.spouseEmploymentStatus) }}
                            {{ form_row(form.spouseMonthlyIncome) }}
                            {{ form_row(form.familyAllowanceAmount) }}
                            {{ form_row(form.alimonyAmount) }}
                            {{ form_row(form.rentAmountNetAide) }}
                        </div></div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#id4">4. Demande</button></h2>
                        <div id="id4" class="accordion-collapse collapse"><div class="accordion-body">
                            {{ form_row(form.requestType) }}
                            {{ form_row(form.requestDuration) }}
                            {{ form_row(form.otherRequestDuration) }}
                            {{ form_row(form.requestReason) }}
                            {{ form_row(form.otherNeed) }}
                            {{ form_row(form.urgencyLevel) }}
                            {{ form_row(form.urgencyExplanation) }}
                            {{ form_row(form.otherComment) }}
                        </div></div>
                    </div>

                    <div class="accordion-item">
                        <h2 class="accordion-header"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#id5">5. Documents</button></h2>
                        <div id="id5" class="accordion-collapse collapse"><div class="accordion-body">
                            {{ form_row(form.identityProofFilename) }}
                            {{ form_row(form.incomeProofFilename) }}
                            {{ form_row(form.taxNoticeFilename) }}
                            {{ form_row(form.quittanceLoyer) }}
                            {{ form_row(form.avisCharge) }}
                            {{ form_row(form.taxeFonciere) }}
                            {{ form_row(form.fraisScolarite) }}
                            {{ form_row(form.attestationCaf) }}
                            {{ form_row(form.otherDocumentFilename) }}
                        </div></div>
                    </div>

                </div>
            </div>

            <div class="d-flex flex-column justify-content-center mt-4">
                {{ form_row(form.privacyConsent) }}
              <small class="form-text text-muted">
                En cochant cette case, vous acceptez notre 
                <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">politique de confidentialit√©</a>.
              </small>

            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg shadow-sm edit-btn">
                    üíæ Soumettre ma nouvelle demande
                </button>
            </div>

        </form> 
        <div class="text-center mt-4" style="animation-delay:.3s">
            <a href="{{ path('app_aidrequest_existing') }}" class="btn btn-outline-primary btn-lg shadow-sm edit-btn">
                ‚¨ÖÔ∏è Retour
            </a>
        </div>

    </div>

    <footer class="footer-custom text-center text-muted small py-4">
        <div class="footer-line mx-auto"></div>
        <p class="mt-3">¬© 2025 Espace Famille Yad Alev</p>
    </footer>
</div>
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="privacyModalLabel">Termes & Conditions ‚Äì Politique de confidentialit√©</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body" style="line-height:1.6">

        <p><strong>L'Association Yad Alev</strong> s'engage √† prot√©ger la confidentialit√© des informations personnelles collect√©es via ce formulaire de demande d'aide. 
        Les informations fournies seront utilis√©es uniquement dans le but de traiter et de r√©pondre √† votre demande d'aide
         (ou de la compl√©ter par toutes autres aides que l'association jugera utile de vous proposer).
        </p>

        <h6 class="mt-3">Collecte et utilisation des informations</h6>
        <p> Les informations personnelles collect√©es, telles que le nom, l'adresse et les coordonn√©es, ne seront utilis√©es que dans le cadre du traitement de votre demande d'aide. 
        Ces informations pourront √™tre trait√©es par Yad Alev, ses membres & b√©n√©voles, 
        mais √©galement par nos partenaires associatifs dans le cadre d'un accompagnement social plus complet.
        Les d√©tails financiers fournis seront trait√©s de mani√®re confidentielle et ne seront utilis√©s que pour √©valuer votre admissibilit√© √† l'aide demand√©e ou toutes autres aides que Yad Alev jugera utile de vous proposer. 
        Aucune information personnelle ne sera partag√©e, lou√©e ou vendue √† des tiers non mentionn√©s (hors partenaires associatifs) sans votre consentement pr√©alable, sauf si cela est requis par la loi.</p>

        <h6 class="mt-3">S√©curit√© des donn√©es</h6>
        <p>Nous mettons en ≈ìuvre des mesures de s√©curit√© appropri√©es pour prot√©ger vos informations personnelles contre tout acc√®s non autoris√©, toute divulgation ou toute alt√©ration. Seuls les membres autoris√©s de l'Association Yad Alev 
        (ou les partenaires associatifs) auront acc√®s √† vos informations personnelles, et ce, dans le seul but de traiter votre demande d'aide.</p>

        <h6 class="mt-3">Conservation</h6>
        <p>Vos informations personnelles seront conserv√©es aussi longtemps que n√©cessaire pour atteindre les objectifs pour lesquels elles ont √©t√© collect√©es
        , sauf si une p√©riode de conservation plus longue est requise par la loi.</p>

        <h6 class="mt-3">Droits</h6>
        <p>Vous pouvez demander acc√®s, modification ou suppression de vos donn√©es :</p>
        <p>Vous avez le droit de demander l'acc√®s, la rectification ou la suppression de vos informations personnelles. 
        Pour exercer ces droits ou pour toute question concernant notre politique de confidentialit√©, veuillez nous contacter √† l'adresse indiqu√©e ci-dessous.</p>

        <h6 class="mt-3">Contact</h6>
        <p>Pour toute question ou pr√©occupation concernant notre politique de confidentialit√© ou
         pour exercer vos droits sur vos donn√©es personnelles, veuillez nous contacter √† l'adresse suivante : yadalev@outlook.fr </p>

      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
      </div>

    </div>
  </div>
</div>s

<style>
/* ... ton CSS ... */
.navbar { border-bottom: 1px solid #e2e8f0; }
.nav-logo { width: 48px; }
.nav-icon { font-size: 1.4rem; color:#444; transition:.2s; }
.main-container { min-height: 100vh; display: flex; flex-direction: column; }
.info-card { background: #fff; border-radius: 1rem; border: 1px solid #e2e8f0; }
.accordion-button:not(.collapsed) { background: #e8f0ff; color: #0d6efd; }
.fade-in { opacity:0; animation: fadeSlide .7s ease forwards; }
@keyframes fadeSlide { from { opacity:0; transform: translateY(25px); } to { opacity:1; transform:translateY(0); } }
.footer-line { width: 85%; height: 1px; background:#d0d7e0; }
</style>
{% endblock %}